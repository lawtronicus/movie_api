<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: validation.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: validation.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const Models = require("./models.js");
let Users = Models.User;

/**
 * Checks if a specific field in the Users collection is unique.
 *
 * This function can be used to validate if a specific field, such as email or username,
 * is already in use by another user.
 *
 * @param {string} field - The field to check for uniqueness (e.g., "email", "username").
 * @param {string} value - The value of the field to check for uniqueness.
 * @param {string|null} [userId=null] - Optional. The ID of the user to exclude from the uniqueness check. This is useful for updates, where the current user's field should not be considered a duplicate.
 * @returns {Promise&lt;boolean>} - Returns a promise that resolves to `true` if the field is unique, `false` otherwise.
 *
 * @example
 * // Check if email is unique (for new users)
 * const isEmailUnique = await isUnique('email', 'user@example.com');
 *
 * @example
 * // Check if username is unique (for updating a user, excluding their own ID)
 * const isUsernameUnique = await isUnique('username', 'new_username', 'user_id_here');
 */
async function isUnique(field, value, userId = null) {
  const query = { [field]: value };

  // Exclude the current user if updating
  if (userId) {
    query._id = { $ne: userId };
  }

  // Check for an existing user with the same field value
  const user = await Users.findOne(query);

  // If no user is found, the field is unique
  return !user;
}

module.exports = {
  isUnique,
  // Add other validation functions here when created
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#AddFavoriteMovie">AddFavoriteMovie</a></li><li><a href="global.html#CreateUser">CreateUser</a></li><li><a href="global.html#DeleteUser">DeleteUser</a></li><li><a href="global.html#ErrorHandler">ErrorHandler</a></li><li><a href="global.html#GetAllMovies">GetAllMovies</a></li><li><a href="global.html#GetAllUsers">GetAllUsers</a></li><li><a href="global.html#GetDirectorByName">GetDirectorByName</a></li><li><a href="global.html#GetGenreByName">GetGenreByName</a></li><li><a href="global.html#GetMovieByTitle">GetMovieByTitle</a></li><li><a href="global.html#GetMovieDescription">GetMovieDescription</a></li><li><a href="global.html#GetMovieDirectors">GetMovieDirectors</a></li><li><a href="global.html#GetMovieGenres">GetMovieGenres</a></li><li><a href="global.html#GetMovieImage">GetMovieImage</a></li><li><a href="global.html#GetMovieMainActor">GetMovieMainActor</a></li><li><a href="global.html#GetMovieWriters">GetMovieWriters</a></li><li><a href="global.html#GetUserById">GetUserById</a></li><li><a href="global.html#RemoveFavoriteMovie">RemoveFavoriteMovie</a></li><li><a href="global.html#StartServer">StartServer</a></li><li><a href="global.html#UpdateUser">UpdateUser</a></li><li><a href="global.html#WelcomeMessage">WelcomeMessage</a></li><li><a href="global.html#actorSchema">actorSchema</a></li><li><a href="global.html#auth">auth</a></li><li><a href="global.html#directorSchema">directorSchema</a></li><li><a href="global.html#generateJWTToken">generateJWTToken</a></li><li><a href="global.html#genreSchema">genreSchema</a></li><li><a href="global.html#isUnique">isUnique</a></li><li><a href="global.html#movieSchema">movieSchema</a></li><li><a href="global.html#passport">passport</a></li><li><a href="global.html#userSchema">userSchema</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a> on Tue Sep 17 2024 13:13:28 GMT+0800 (Philippine Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
